# shave_project
Учебный проект

### Вводная
Мы компания которая продает айфоны. Недавно мы обнаружили, что мы не можем нормально конкурировать на рынке и давать ту цену, которую хочет покупатель. Поэтому мы провели маркетинговый анализ и решили, что надо попробовать аффилиатный маркетинг для того, чтобы повысить свои продажи за счет сторонних сайтов.
Мы обратились к ***, для того, чтобы он все нам настроил, однако оказалось, что у них там все основано на каких-то куках и метках. Прозвучало очень сложно, но наш технический директор сказал, что это очень хорошо, потому что мы сможем настроить все так, чтобы эти самые куки и метки иногда пропадали и мы бы не платили за заказ. Директор по маркетингу сказал, что нас быстро раскусят, но тех дир ответил, что сделает все так, чтобы куки и метки удалилсь рандомным образом с разных устройств и никто не сможет ничего понять.

### Итерация первая - Пора достать бритвы.
К тебе приходит технический директор и говорит, что твоя задача реализовать микросервис, который принимает запросы. Этот сервис имеет 2 ручки: /auth и /shave.

### auth
Это ручка авторизации, она:
* проверяет допуск пользователя по логину и паролю переданному в теле запроса в виде json.  
-- если допуск есть - то она редиректит пользователя на ендпоинт /shave, со всемми гет параметрами, которые были в ссылке и проставляет ему идентификтор в куку.  
-- если нет, то отдает сообщение, что допуск запрещен
* список разрешенных пользователей и их паролей на этой итерации лежит в yaml файле. У каждого пользователя уникальный идентификатор.

### shave
Это ручка мухлежа, она:
* умеет получать идентификатор пользователя
* умеет проверять, как давно мы мухлевали с этим пользователем. Если мухлевали более 1 минуты назад (для быстроты тестирования), то можно снова мухлевать.

#### В чем заключается мухлеж:
* ручка очищает из запроса все utm параметры и конечно же параметр admitad_uid
* ручка очищает все куки пользователя кроме его куки идентификации
* после чего редиректит на ендпоинт /marketplace (который может отдавать что угодно)
если же мухлевать нельзя, то ручка редиректит на marketplace без очищения всего.

### общие требования
* в консоль должно логироваться, что тот или иной пользователь **получил** авторизацию или **не получил** ее
* в консоль должно логироваться, что мы стали или не стали шейвить с тем или иным пользователем
* на функции должны быть написаны юнит тесты